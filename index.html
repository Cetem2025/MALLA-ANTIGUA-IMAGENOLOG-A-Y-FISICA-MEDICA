<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Radiología - Interactiva</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f4;
    }
    .grid {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 16px;
    }
    .column {
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 10px;
      min-width: 220px;
      padding: 12px;
      flex-shrink: 0;
    }
    .column h3 {
      text-align: center;
      background-color: #653f90;
      color: #fff;
      border-radius: 8px;
      padding: 6px;
    }
    .subject {
      background-color: #d7d2e6;
      border-radius: 8px;
      padding: 8px;
      margin: 6px 0;
      text-align: center;
      cursor: pointer;
      position: relative;
    }
    .subject.completed {
      background-color: #7fd887;
      text-decoration: line-through;
    }
    .subject.locked {
      background-color: #e0e0e0;
      color: #999;
      cursor: not-allowed;
    }
    .subject[data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      white-space: nowrap;
      font-size: 12px;
      z-index: 10;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Imagenología y Física Médica</h1>
  <div class="grid" id="grid">
    <!-- Columnas por semestre -->
  </div>

  <script>
    const malla = [
      { semestre: "Semestre 1", asignaturas: ["Matemática", "Biología Celular", "Química General y Orgánica", "Inglés I", "Formación Integral I"] },
      { semestre: "Semestre 2", asignaturas: ["Introducción a la Física", "Bioquímica General", "Histomorfobiología", "Anatomía Humana", "Inglés II", "Formación Integral II"] },
      { semestre: "Semestre 3", asignaturas: ["Inmunología Básica", "Fisiología Humana", "Anatomía Humana Avanzada", "Bioseguridad", "Estadística", "Formación Integral III"] },
      { semestre: "Semestre 4", asignaturas: ["Orientación Profesional", "Fisiopatología Humana", "Psicología del Paciente", "Infectología", "Farmacología General"] },
      { semestre: "Semestre 5", asignaturas: ["Radiodiagnóstico I", "Anatomía Radiológica", "Radioprotección y Dosimetría", "Radiofísica", "Epidemiología y Salud Pública"] },
      { semestre: "Semestre 6", asignaturas: ["Radiodiagnóstico II", "Electrónica Médica", "Patología Radiológica", "Administración en Salud"] },
      { semestre: "Semestre 7", asignaturas: ["Resonancia Magnética", "Tomografía Computada", "Neuroimagenología", "Gestión y Calidad"] },
      { semestre: "Semestre 8", asignaturas: ["Medicina Nuclear", "Radioterapia", "Introducción a la Ecografía", "Análisis Clínico Integrado", "Bioestadística y Metodología"] },
      { semestre: "Semestre 9", asignaturas: ["Internado"] },
      { semestre: "Semestre 10", asignaturas: ["Seminario de Investigación", "Formulación de Proyectos", "Prevención en Salud"] },
    ];

    const grid = document.getElementById("grid");
    const completadas = JSON.parse(localStorage.getItem("aprobadas") || "[]");

    malla.forEach(({ semestre, asignaturas }) => {
      const col = document.createElement("div");
      col.className = "column";

      const title = document.createElement("h3");
      title.textContent = semestre;
      col.appendChild(title);

      asignaturas.forEach(asig => {
        const div = document.createElement("div");
        div.className = "subject";
        div.textContent = asig;
        div.dataset.name = asig;

        if (completadas.includes(asig)) div.classList.add("completed");

        div.addEventListener("click", () => {
          if (div.classList.contains("locked")) return;
          div.classList.toggle("completed");
          const name = div.dataset.name;
          if (div.classList.contains("completed")) {
            completadas.push(name);
          } else {
            const index = completadas.indexOf(name);
            if (index > -1) completadas.splice(index, 1);
          }
          localStorage.setItem("aprobadas", JSON.stringify(completadas));
          actualizarBloqueos();
        });
        col.appendChild(div);
      });
      grid.appendChild(col);
    });

    // (Placeholder) Aquí irían los prerrequisitos reales
    const prerrequisitos = {
      "Radiodiagnóstico II": ["Radiodiagnóstico I"],
      "Resonancia Magnética": ["Radiodiagnóstico II"],
      "Medicina Nuclear": ["Radiodiagnóstico II"],
      "Internado": ["Radioterapia"],
      "Seminario de Investigación": ["Bioestadística y Metodología"]
    };

    function actualizarBloqueos() {
      document.querySelectorAll(".subject").forEach(div => {
        const nombre = div.dataset.name;
        const requisitos = prerrequisitos[nombre] || [];
        const cumplido = requisitos.every(r => completadas.includes(r));
        div.classList.toggle("locked", !cumplido);
        if (!cumplido) {
          div.dataset.tooltip = "Prerrequisito: " + requisitos.join(", ");
        } else {
          delete div.dataset.tooltip;
        }
      });
    }

    actualizarBloqueos();
  </script>
</body>
</html>
